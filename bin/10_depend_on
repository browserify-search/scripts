#! /usr/bin/env node

var cmdLn = require('cmd-ln')
var db = require('../lib/db')
var pick10 = require('../lib/pick_10')

cmdLn(function(coreDep){
  db(function(err, db){
    if (err) return console.error(err.message)
    var modules = db.collection('modules')
    var criteria = {}
    criteria['testResults.coreDeps.' + coreDep] = true
    modules.find(criteria).toArray(function(err, modules){
      if (err) console.error(err.message)
      if (modules){
        pick10(modules).map(function(module){
          console.log(module.name)
        })
      }
      db.close()
    })
  })  
})
